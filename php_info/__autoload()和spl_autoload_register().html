<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>__autoload()和spl_autoload_register()</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
<h2 style="text-align: center">__autoload()和spl_autoload_register()</h2>
  <div class="stackedit__html"><h5><a id="__autoload_0"></a>一、__autoload（）</h5>
<blockquote>
<p>这是一个自动加载函数，在PHP5中，当我们实例化一个未定义的类时，就会触发此函数。看下面例子：<br>
AutoLoad.php：</p>
</blockquote>
<pre><code class="prism language-php">	<span class="token delimiter important">&lt;?php</span>
	<span class="token keyword">class</span> <span class="token class-name">AutoLoad</span> <span class="token punctuation">{</span>
		 <span class="token keyword">function</span> <span class="token function">getAoto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 	<span class="token keyword">echo</span> <span class="token single-quoted-string string">'hello world'</span><span class="token punctuation">;</span>
		 <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
</code></pre>
<blockquote>
<p>index.php:</p>
</blockquote>
<pre><code class="prism language-php">	<span class="token delimiter important">&lt;?php</span>
	<span class="token keyword">function</span> <span class="token function">__autoload</span><span class="token punctuation">(</span> <span class="token variable">$classname</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$classname</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'.php'</span><span class="token punctuation">;</span>
		 <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 	<span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		 <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AutoLoad</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$obj</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getAoto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>运行index.php后正常输出hello world。在index.php中实例化AutoLoad如果文件中找不到这个类会自动调用__autoload(）来把AutoLoad 作为参数传入自动加载的方法中然后在进行文件引入。</p>
<h5><a id="spl_autoload_register_25"></a>二、spl_autoload_register（）</h5>
<blockquote>
<p>这个函数与__autoload有与曲同工之妙,不需要封装函数自动加载。spl_autoload_register($params) 加载函数</p>
</blockquote>
<pre><code class="prism language-php">	<span class="token delimiter important">&lt;?php</span>
	<span class="token comment">//1 匿名函数引入</span>
	<span class="token function">spl_autoload_register</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$classname</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		 <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$classname</span>  <span class="token punctuation">.</span> <span class="token single-quoted-string string">'.php'</span><span class="token punctuation">;</span>
		 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 	<span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		 <span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//2.或者把函数封装</span>
	<span class="token keyword">function</span> <span class="token function">goLoad</span><span class="token punctuation">(</span> <span class="token variable">$classname</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$classname</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'.php'</span><span class="token punctuation">;</span>
		 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 	<span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		 <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">spl_autoload_register</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'goLoad'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//3.调用类中的文件加载方法</span>
	<span class="token keyword">class</span> <span class="token class-name">Load</span><span class="token punctuation">{</span>
		<span class="token keyword">function</span> <span class="token function">goLoad</span><span class="token punctuation">(</span><span class="token variable">$classname</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$classname</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'.php'</span><span class="token punctuation">;</span>
			 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			 	<span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			 <span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">spl_autoload_register</span><span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Load</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'goLoad'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//spl_autoload_register(('Load','goLoad')) 如果是静态类可以这样：spl_autoload_register(("Load::goLoad")) </span>
	<span class="token comment">//这里实例化,如果没有定义当前类会自动加载并且引入类文件</span>
	<span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AutoLoad</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$obj</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getAoto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
</code></pre>
</div>
</body>

</html>
